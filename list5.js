import{D as b,A as y,a as w}from"./index4.js";import{R as x}from"./relative-time.js";import{u as h}from"./use-table.js";import{R as o,p as F,r as A,d as N,a as E}from"./index.js";import{d as P,aV as C,L as k,y as B,af as D,w as R,o as z,h as e,F as T,bw as I,bx as M,by as U,bz as L,J as S,z as n,Y as q,A as H,bl as V,bA as G,bB as J,bs as d}from"./vendor.js";import{H as p}from"./rounded-button.js";import"./TelegramPlane.js";import"./Add12Filled.js";import"./Delete16Regular.js";const re=P({setup(K,Y){const{data:g,pager:r,sortProps:_,fetchDataFn:f}=h((a,u)=>async(v=i.query.page||1,j=30)=>{const c=await o.api.projects.get({params:{page:v,size:j}});a.value=c.data,u.value=c.pagination}),t=C(new Set),l=k(),m=B(),i=D(),s=f;return R(()=>i.query.page,async a=>{await s(a)}),z(async()=>{await s()}),()=>e(E,null,{actions:()=>e(T,null,e(p,{variant:"error",disabled:t.size==0,onClick:()=>{m.warning({title:"\u8B66\u544A",content:"\u4F60\u786E\u5B9A\u8981\u5220\u9664\uFF1F",positiveText:"\u786E\u5B9A",negativeText:"\u4E0D\u786E\u5B9A",onPositiveClick:async()=>{await Promise.all(Array.from(t.values()).map(a=>o.api.projects(a).delete())),t.clear(),l.success("\u5220\u9664\u6210\u529F"),await s()}})},icon:e(b,null)}),e(p,{to:"/projects/edit",icon:e(y,null)})),default:()=>e(I,{bordered:!1},{footer(){return e("div",{class:"flex justify-end"},e(M,{itemCount:r.value.total,pageCount:r.value.totalPage,page:r.value.currentPage,pageSize:r.value.size,onUpdatePage:a=>{s(a)}}))},default(){return g.value.map(a=>e(U,{key:a.id},{prefix(){return e(L,{class:"mt-4",checked:t.has(a.id),onUpdateChecked:u=>{u?t.add(a.id):t.delete(a.id)}})},default(){return e(S,{description:a.description},{header(){return e("div",null,e(n,{text:!0,class:"!font-medium",...a.projectUrl?{tag:"a",href:a.projectUrl,target:"_blank"}:{}},a.name))},footer(){return e(q,null,e(H,{class:"pl-[3.6rem] text-[var(--clear-color-pressed)] text-sm"},e("span",null,"\u521B\u5EFA\u4E8E ",F(a.created)),a.modified&&e("span",null,"\u66F4\u65B0\u4E8E"," ",e(x,{time:a.modified}))))},"header-extra"(){return e(V,null,e(n,{onClick:()=>{A.push({name:N.EditProject,query:{id:a.id}})}},"\u7F16\u8F91"),e(G,{class:"!p-0",options:[{value:"del",label:"",render(){return e(n,{type:"error",bordered:!1,onClick:async()=>{await o.api.projects(a.id).delete(),l.success("\u5220\u9664\u6210\u529F"),await s(r.value.currentPage)}},"\u5220\u9664")}}]},e(n,{class:"!px-2"},e(J,null,e(w,null)))))},avatar(){return a.avatar?e(d,{class:"align-center",circle:!0,src:a.avatar,size:"large"}):e(d,{circle:!0,size:"large",class:"align-center"},a.name[0].toUpperCase())}})}}))}})})}});export{re as default};
